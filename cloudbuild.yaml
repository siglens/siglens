steps:

  - name: golang:1.19
    entrypoint: /bin/bash
    args:
      - -c
      - |
        make build && \
        echo "Build Complete" && \
        ./siglens --config server.yaml & \
        echo "STARTING SERVER"

  - name: golang:1.19
    entrypoint: /bin/bash
    args:
      - -c
      - |
        ./siglens --config server.yaml & \
        sleep 30
        
  - name: golang:1.19
    entrypoint: /bin/bash
    args:
      - -c
      - |
        cd tools/sigclient && \
        go run main.go functional -d http://localhost:8081/elastic -f functionalQueries/functionalQueries.yml -q localhost:5122


timeout: 3600s

options:
 defaultLogsBucketBehavior: REGIONAL_USER_OWNED_BUCKET
